---
toc: content
title: 'å›½é™…åŒ–ï¼ˆi18nï¼‰'
order: '24'
---

KWC å›½é™…åŒ–æœåŠ¡åº“ï¼Œä¸º KWC åº”ç”¨æä¾›å®Œæ•´çš„å›½é™…åŒ–è§£å†³æ–¹æ¡ˆã€‚

## åŠŸèƒ½ç‰¹æ€§

- ğŸŒ å¤šè¯­è¨€æ”¯æŒ
- ğŸ”„ åŠ¨æ€è¯­è¨€åˆ‡æ¢
- ğŸ“¦ æŒ‰éœ€åŠ è½½è¯­è¨€åŒ…
- ğŸ¯ åµŒå¥—é”®å€¼ç¿»è¯‘
- ğŸ”§ çµæ´»çš„é…ç½®é€‰é¡¹
- ğŸ“± è‡ªåŠ¨æ£€æµ‹æµè§ˆå™¨è¯­è¨€
- ğŸ¢ é›†æˆ BOS ç³»ç»Ÿè¯­è¨€è®¾ç½®

## å®‰è£…

    npm install @kdcloudjs/kwc-i18n

## åŸºæœ¬ä½¿ç”¨

### å¯¼å…¥å’Œåˆå§‹åŒ–

```js
import { t, loadLanguage, changeLocale } from '@kdcloudjs/kwc-i18n';

// åŸºæœ¬ç¿»è¯‘
const message = t('alert.defaultLabel'); // "è­¦å‘Š"

// å–ä¸åˆ°å¯¹åº”è¯æ¡æ—¶ä½¿ç”¨fallbackå€¼æ›¿ä»£
const greeting = t('welcome.message', { fallback: 'Welcome' });
```

### å®Œæ•´ API å¯¼å…¥

```js
import {
  t, // ç¿»è¯‘å‡½æ•°
  tAsync, // å¼‚æ­¥ç¿»è¯‘å‡½æ•°
  lang, // å½“å‰è¯­è¨€
  locale, // å½“å‰è¯­è¨€ç¯å¢ƒ
  loadLanguage, // åŠ è½½è¯­è¨€åŒ…
  addTranslation, // æ·»åŠ å•ä¸ªç¿»è¯‘
  addTranslations, // æ·»åŠ å¤šä¸ªç¿»è¯‘
  clearTranslation, // æ¸…é™¤ç¿»è¯‘ç¼“å­˜
  getAvailableLanguages, // è·å–å¯ç”¨è¯­è¨€
  changeLocale, // åˆ‡æ¢è¯­è¨€ç¯å¢ƒ
  onLocaleChange, // ç›‘å¬è¯­è¨€ç¯å¢ƒå˜åŒ–
  offLocaleChange, // ç§»é™¤è¯­è¨€ç¯å¢ƒç›‘å¬
} from '@kdcloudjs/kwc-i18n';
```

## è¯¦ç»†ä½¿ç”¨æ–¹æ³•

### 1. åŸºæœ¬ç¿»è¯‘

```js
// ç®€å•ç¿»è¯‘
const label = t('buttonMenu.loading'); // "åŠ è½½ä¸­..."

// åµŒå¥—é”®å€¼ç¿»è¯‘
const color = t('colorPicker.blueAbbr'); // "è“"
```

### 2. åŠ¨æ€åŠ è½½è¯­è¨€åŒ…

```js
// åŠ è½½è‹±æ–‡è¯­è¨€åŒ…
await loadLanguage('en_US', '/path/to/en_US.json');

// åˆå¹¶æ¨¡å¼åŠ è½½ï¼ˆä¿ç•™å·²æœ‰ç¿»è¯‘ï¼‰
await loadLanguage('en_US', '/path/to/additional_en_US.json', true);
```

### 3. æ·»åŠ è‡ªå®šä¹‰ç¿»è¯‘

```js
// æ·»åŠ å•ä¸ªç¿»è¯‘
addTranslation('zh_CN', 'custom.message', 'è‡ªå®šä¹‰æ¶ˆæ¯');

// æ·»åŠ å¤šä¸ªç¿»è¯‘
addTranslations('zh_CN', {
  custom: {
    title: 'è‡ªå®šä¹‰æ ‡é¢˜',
    description: 'è‡ªå®šä¹‰æè¿°',
  },
});
```

### 4. è¯­è¨€ç¯å¢ƒç®¡ç†

```js
// è·å–å½“å‰è¯­è¨€ç¯å¢ƒ
console.log(locale); // 'zh_CN'

// åˆ‡æ¢è¯­è¨€ç¯å¢ƒ
changeLocale('en_US');

// ç›‘å¬è¯­è¨€ç¯å¢ƒå˜åŒ–
const handleLocaleChange = (newLocale, oldLocale) => {
  console.log(`è¯­è¨€ä» ${oldLocale} åˆ‡æ¢åˆ° ${newLocale}`);
};

onLocaleChange(handleLocaleChange);

// ç§»é™¤ç›‘å¬å™¨
offLocaleChange(handleLocaleChange);
```

### 5. å¼‚æ­¥ç¿»è¯‘

```js
// å¼‚æ­¥è·å–ç¿»è¯‘ï¼ˆé€‚ç”¨äºéœ€è¦åŠ¨æ€åŠ è½½çš„åœºæ™¯ï¼‰
const asyncMessage = await tAsync('some.key');
const asyncGreeting = await tAsync('welcome.message', { fallback: 'Welcome' });
const asyncFallback = await tAsync('non.existent.key', {
  fallback: 'Fallback',
  path: 'path/to/en_US.json',
});
```

### 6. æ¸…é™¤ç¿»è¯‘ç¼“å­˜

```js
// æ¸…é™¤æŒ‡å®šè¯­è¨€çš„ç¿»è¯‘ç¼“å­˜
clearTranslation('en_US');
```

## æ¨¡å—åŒ–ä½¿ç”¨

### å•ç‹¬ä½¿ç”¨ i18n æ¨¡å—

```bash
import { t, loadLanguage } from '@kdcloudjs/kwc-i18n/i18n';
```

### å•ç‹¬ä½¿ç”¨ locale æ¨¡å—

```bash
import { setLocale, addLocaleListener } from '@kdcloudjs/kwc-i18n/locale';
```

### å•ç‹¬ä½¿ç”¨ lang æ¨¡å—

```bash
import lang from '@kdcloudjs/kwc-i18n/lang';
```

## è¯­è¨€æ£€æµ‹ä¼˜å…ˆçº§

ç³»ç»ŸæŒ‰ä»¥ä¸‹ä¼˜å…ˆçº§è‡ªåŠ¨æ£€æµ‹è¯­è¨€ï¼š

1.  URL å‚æ•°ä¸­çš„ `lang` å‚æ•°
2.  BOS ç³»ç»Ÿé…ç½®çš„è¯­è¨€è®¾ç½®
3.  æµè§ˆå™¨è¯­è¨€è®¾ç½®
4.  BOS ç³»ç»Ÿé»˜è®¤è¯­è¨€

## ç¿»è¯‘æ–‡ä»¶æ ¼å¼

ç¿»è¯‘æ–‡ä»¶åº”ä¸º JSON æ ¼å¼ï¼Œæ”¯æŒåµŒå¥—ç»“æ„ï¼š

```json
{
  "alert": {
    "defaultLabel": "è­¦å‘Š"
  },
  "buttonMenu": {
    "loading": "åŠ è½½ä¸­...",
    "showMenu": "å±•ç¤ºèœå•"
  },
  "colorPicker": {
    "cancelButton": "å–æ¶ˆ",
    "doneButton": "å®Œæˆ"
  }
}
```

## æ„å»ºå’Œå‘å¸ƒ

```bash
# æ„å»ºé¡¹ç›®
npm run build

# å‘å¸ƒå‰æ„å»º
npm run prepublish
```

## é¡¹ç›®ç»“æ„

    src/
    â”œâ”€â”€ index.js              # ä¸»å…¥å£æ–‡ä»¶
    â””â”€â”€ modules/
        â”œâ”€â”€ i18n/            # æ ¸å¿ƒç¿»è¯‘åŠŸèƒ½
        â”œâ”€â”€ lang/            # è¯­è¨€ç®¡ç†
        â”œâ”€â”€ locale/          # è¯­è¨€ç¯å¢ƒç®¡ç†
        â””â”€â”€ locales/         # é»˜è®¤ç¿»è¯‘æ–‡ä»¶
            â””â”€â”€ zh_CN.json   # ä¸­æ–‡ç¿»è¯‘

## æ³¨æ„äº‹é¡¹

- åº“ä¼šè‡ªåŠ¨åˆå§‹åŒ–ä¸­æ–‡ç¿»è¯‘
- æ”¯æŒ CommonJS å’Œ ES Module ä¸¤ç§å¯¼å…¥æ–¹å¼
- ç¿»è¯‘é”®æ”¯æŒç‚¹å·åˆ†éš”çš„åµŒå¥—è®¿é—®
- è¯­è¨€ä»£ç æ ¼å¼ï¼š`zh_CN`ã€`en_US` ç­‰

## è®¸å¯è¯

è¯·æŸ¥çœ‹é¡¹ç›®è®¸å¯è¯æ–‡ä»¶ã€‚
